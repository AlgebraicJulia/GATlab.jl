<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Scopes · GATlab.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GATlab.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">GATlab.jl</a></li><li><span class="tocitem">Concepts</span><ul><li><a class="tocitem" href="../overview/">For Catlab users</a></li><li><a class="tocitem" href="../theories/">Theories</a></li><li><a class="tocitem" href="../models/">Model families</a></li></ul></li><li><a class="tocitem" href="../../api/">Library Reference</a></li><li><a class="tocitem" href="../../stdlib/">Standard Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Scopes</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Scopes</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/AlgebraicJulia/GATlab.jl/blob/main/docs/src/concepts/scopes.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Scopes"><a class="docs-heading-anchor" href="#Scopes">Scopes</a><a id="Scopes-1"></a><a class="docs-heading-anchor-permalink" href="#Scopes" title="Permalink"></a></h1><p>Design rationale:</p><p>Namespacing should be first class. This doesn&#39;t play nicely with deBruijn levels; we don&#39;t want to do a bunch of math to convert between flattened and unflattened versions of contexts. There is an accepted solution to the problem of organizing names: use refs! Mathematically speaking, a ref is just a list of deBruijn levels.</p><p>However, deBruijn levels are unfriendly for users; we want to be able to give names to our variables!</p><p>In general, naming is given by a <em>relation</em> between symbols and bindings (as referred to by deBruijn levels). Each binding may be associated with zero or more symbols, and each symbol might be associated with zero or more bindings.</p><p>We name the failure of this relation to be a bijection in several ways.</p><ul><li>If more than one symbol is related to a single binding, we say that this</li></ul><p>binding has <em>aliases</em>. In this case, we should also have a <em>primary alias</em> used as a default.</p><ul><li>If more than one binding is related to a single symbol, we have <em>name overlap</em>.</li></ul><p>Name overlap can be resolved by <em>overloading</em> and <em>shadowing</em>, we will talk about this later on.</p><ul><li>If no symbol is related to a binding, such as when the binding is created</li></ul><p>programmatically, we need <em>nameless references</em> to be able to refer to the binding, which are also created programmatically.</p><ul><li>If no binding is related to a symbol, then we have a <em>name error</em>; this name</li></ul><p>is not valid in the current context and we must throw an error.</p><p>The most important thing to get right is <em>name overlap</em>; we discuss this first.</p><p>There are two ways in which to resolve name overlap.  The first way is via <em>overloading</em>. In overloading, we disambiguate an ambiguous name via its context, for instance what type it is expected to be, or what arguments is it receiving. The second way is via <em>shadowing</em>. In shadowing, a name is resolved by making it point to the &quot;most recently defined&quot; thing with that name.</p><p>In GATlab, we handle overloading and shadowing with a notion of <em>scope</em>. Anything which binds variables introduces a scope, for instance a <code>@theory</code> declaration or a context. Each scope is identified with a ScopeTag, which is an opaque identifier (i.e. a UUID). We take this idea from Racket, but we don&#39;t need the more complex &quot;scope sets&quot; from Racket because GATs don&#39;t need to process the syntax of other GATs; if we start doing this we&#39;ll have to rethink the design, but we&#39;ll probably have bigger problems too.</p><p>Two variables with the same name within a single scope are meant to overload one another. For instance, this is what happens with <code>mcompose</code> in the theory of monoidal categories; it is overloaded for <code>Hom</code> and <code>Ob</code>, and this is what happens with <code>d</code> in the discrete exterior calculus; it is overloaded for all of the (k+1)-forms. Variables in different scopes with the same name <em>shadow</em> one another. When we parse an expression <code>a + b</code>, we do so in an ordered list of scopes, and the most recent scope &quot;wins&quot;.</p><p>Parsing turns a <code>Symbol</code> into an <code>Ident</code>. The <code>Ident</code> contains the original <code>Symbol</code> for printing, but it also contains a reference to a scope via ScopeTag, and an deBruijn level within that scope. Thus, the name in the <code>Ident</code> is never needed for later stages of programatic manipulation.</p><p>Scopes cache the relation between names and bindings, by providing a way to go from binding (as reified by deBruijn level) to a set of aliases with distinguished primary alias, and to go from name to the set of bindings that have that name that we need to disambiguate between in the case of an overload.</p><p>Because <code>Ident</code>s are fully unambiguous even without their name, it is also possible to create an <code>Ident</code> with no name, which solves the problem of <em>nameless references</em>.</p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Wednesday 13 September 2023 16:50">Wednesday 13 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
