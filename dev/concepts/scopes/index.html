<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Scopes · GATlab.jl</title><meta name="title" content="Scopes · GATlab.jl"/><meta property="og:title" content="Scopes · GATlab.jl"/><meta property="twitter:title" content="Scopes · GATlab.jl"/><meta name="description" content="Documentation for GATlab.jl."/><meta property="og:description" content="Documentation for GATlab.jl."/><meta property="twitter:description" content="Documentation for GATlab.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GATlab.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">GATlab.jl</a></li><li><span class="tocitem">Concepts</span><ul><li><a class="tocitem" href="../catlab_differences/">Changes from Catlab GATs</a></li><li class="is-active"><a class="tocitem" href>Scopes</a></li><li><a class="tocitem" href="../theories/">Theories</a></li><li><a class="tocitem" href="../models/">Models and instances</a></li><li><a class="tocitem" href="../symbolic_models/">Symbolic Models</a></li></ul></li><li><a class="tocitem" href="../../api/">Library Reference</a></li><li><a class="tocitem" href="../../stdlib/">Standard Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Concepts</a></li><li class="is-active"><a href>Scopes</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Scopes</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/AlgebraicJulia/GATlab.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/AlgebraicJulia/GATlab.jl/blob/main/docs/src/concepts/scopes.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Scopes"><a class="docs-heading-anchor" href="#Scopes">Scopes</a><a id="Scopes-1"></a><a class="docs-heading-anchor-permalink" href="#Scopes" title="Permalink"></a></h1><p>Design rationale:</p><p>Namespacing, i.e. references which look like <code>britain.economy.GDP</code>, should be first class. This doesn&#39;t play nicely with the internal representation of names via <a href="https://en.wikipedia.org/wiki/De_Bruijn_index">deBruijn levels</a>; we don&#39;t want to do a bunch of math to convert between flattened and nested versions of contexts. Conceptually, we should then switch our identifiers to be <em>lists</em> of deBruijn levels.</p><p>But there are also significant subtleties in the translation between named and nameless representations of identifiers. Also in practice if we are referencing something that might change over time, like a C-set, we don&#39;t want to use deBruijn levels, because we don&#39;t want have to change all of our identifiers when we delete something, so in the rest of this I will instead say &quot;local identifier&quot; instead of deBruijn level to refer to a nameless representation of an identifier.</p><p>(the name &quot;local identifier&quot; and also some of this philosophy is taken from <a href="https://github.com/davidad/chit">chit</a>)</p><p>In general, naming is given by a <em>relation</em> between symbols and <em>bindings</em> (as refered to by local identifiers).  Each binding may be associated with zero or more symbols, and each symbol might be associated with zero or more bindings.</p><p>We name the failure of this relation to be a bijection in several ways.</p><ul><li>If more than one symbol is related to a single binding, we say that this</li></ul><p>binding has <em>aliases</em>. In this case, we should also have a <em>primary alias</em> used as a default.</p><ul><li>If more than one binding is related to a single symbol, we have <em>name overlap</em>.</li></ul><p>Name overlap can be resolved by <em>overloading</em> and <em>shadowing</em>, we will talk about this later on.</p><ul><li>If no symbol is related to a binding, such as when the binding is created</li></ul><p>programmatically, we need <em>nameless references</em> to be able to refer to the binding, which are also created programmatically.</p><ul><li>If no binding is related to a symbol, then we have a <em>name error</em>; this name</li></ul><p>is not valid in the current context and we must throw an error.</p><p>The most important thing to get right is <em>name overlap</em>; we discuss this first.</p><p>There are two ways in which to resolve name overlap.  The first way is via <em>overloading</em>. In overloading, we disambiguate an ambiguous name via its context, for instance what type it is expected to be, or what arguments is it receiving. The second way is via <em>shadowing</em>. In shadowing, a name is resolved by making it point to the &quot;most recently defined&quot; thing with that name.</p><p>In GATlab, we handle overloading and shadowing with a notion of <em>scope</em>. Anything which binds variables introduces a scope, for instance a <code>@theory</code> declaration or a context. Each scope is identified with a ScopeTag, which is an opaque identifier (i.e. a UUID). We take this idea from Racket, but we don&#39;t need the more complex &quot;scope sets&quot; from Racket because GATs don&#39;t need to process the syntax of other GATs; if we start doing this we&#39;ll have to rethink the design, but we&#39;ll probably have bigger problems too.</p><p>Two variables with the same name within a single scope are meant to overload one another. For instance, this is what happens with <code>mcompose</code> in the theory of monoidal categories; it is overloaded for <code>Hom</code> and <code>Ob</code>, and this is what happens with <code>d</code> in the discrete exterior calculus; it is overloaded for all of the (k+1)-forms. Variables in different scopes with the same name <em>shadow</em> one another. When we parse an expression <code>a + b</code>, we do so in an ordered list of scopes, and the most recent scope &quot;wins&quot;.</p><p>Parsing turns a <code>Symbol</code> into an <code>Ident</code>. The <code>Ident</code> contains the original <code>Symbol</code> for printing, but it also contains a reference to a scope via ScopeTag, and an local identifier (&quot;lid&quot;) within that scope. Thus, the name in the <code>Ident</code> is never needed for later stages of programatic manipulation.</p><p>Scopes cache the relation between names and bindings, by providing a way to go from binding (as reified by local identifier) to a set of aliases with distinguished primary alias, and to go from name to the set of bindings that have that name that we need to disambiguate between in the case of an overload.</p><p>Because <code>Ident</code>s are fully unambiguous even without their name, it is also possible to create an <code>Ident</code> with no name, which solves the problem of <em>nameless references</em>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../catlab_differences/">« Changes from Catlab GATs</a><a class="docs-footer-nextpage" href="../theories/">Theories »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Wednesday 27 March 2024 21:55">Wednesday 27 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
